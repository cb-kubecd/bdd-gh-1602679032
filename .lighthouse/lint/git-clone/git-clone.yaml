apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: git-clone
spec:
  steps:
    - script: |
        #!/usr/bin/env bash
        export SUBDIR="source"
        echo "git cloning url: $REPO_URL version $PULL_PULL_SHA to dir: $SUBDIR"
        git config --global --add user.name ${GIT_AUTHOR_NAME:-jenkins-x-bot}
        git config --global --add user.email ${GIT_AUTHOR_EMAIL:-jenkins-x@googlegroups.com}
        git config --global credential.helper store
        git clone $REPO_URL $SUBDIR
        cd $SUBDIR
        git checkout $PULL_PULL_SHA
        echo "checked out revision: $PULL_PULL_SHA to dir: $SUBDIR"
      image: gcr.io/jenkinsxio/builder-jx:2.1.142-761
      name: git-clone
      resources: { }
      workingDir: /workspace
